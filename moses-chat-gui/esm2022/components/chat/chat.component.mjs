import { CommonModule } from '@angular/common';
import { Component, Input, ViewChild, ViewContainerRef, } from '@angular/core';
import { FontAwesomeModule } from '@fortawesome/angular-fontawesome';
import { faPaperPlane } from '@fortawesome/free-regular-svg-icons';
import { faArrowRight } from '@fortawesome/free-solid-svg-icons';
import { MessageComponent } from '../message/message.component';
import { FormsModule } from '@angular/forms';
import * as i0 from "@angular/core";
import * as i1 from "./../../lib/moses-chat-gui.service";
import * as i2 from "@angular/common";
import * as i3 from "@angular/forms";
import * as i4 from "@fortawesome/angular-fontawesome";
export class ChatComponent {
    constructor(service) {
        this.service = service;
        this.customer = 'Customer';
        this.startMessage = 'Zu welcher Metrik, welches Connectors haben Sie eine Frage?';
        this.userInput = '';
        this.hasLoggedIn = this.service.chatHistory.length > 0;
        // Icons
        this.paperPlane = faPaperPlane;
        this.arrowRight = faArrowRight;
    }
    onEnter(event) {
        event.preventDefault();
        this.sendMsg();
    }
    sendMsg() {
        if (this.userInput.trim().length === 0)
            return;
        this.showMsg(this.userInput, false);
        this.showLoadIndicator();
        this.service
            .sendMsg(this.userInput)
            .then((answer) => this.setAnswerToLastMsgEl(answer))
            .catch((err) => this.handleError(err));
        this.userInput = '';
    }
    handleError(err) {
        console.error(err);
        this.lastMsg?.destroy();
    }
    showLoadIndicator() {
        this.lastMsg = this.chatEl.createComponent(MessageComponent);
        this.lastMsg.instance.isAnswer = true;
        this.lastMsg.instance.isLoadIndicator = true;
        this.chatEl.element.nativeElement.appendChild(this.lastMsg.location.nativeElement);
        this.scrollToBottom();
    }
    setAnswerToLastMsgEl(answer) {
        const msg = this.lastMsg?.instance;
        if (msg != null) {
            msg.isLoadIndicator = false;
            msg.message = answer;
        }
        this.scrollToBottom();
    }
    showMsg(msg, isAnswer) {
        this.lastMsg = this.chatEl.createComponent(MessageComponent);
        this.lastMsg.instance.isAnswer = isAnswer;
        this.lastMsg.instance.message = msg;
        this.chatEl.element.nativeElement.appendChild(this.lastMsg.location.nativeElement);
        this.scrollToBottom();
    }
    scrollToBottom() {
        setTimeout(() => {
            const chatEl = this.chatEl.element.nativeElement;
            chatEl.scrollTop = chatEl.scrollHeight;
        });
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.3.3", ngImport: i0, type: ChatComponent, deps: [{ token: i1.MosesChatGuiService }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "17.3.3", type: ChatComponent, isStandalone: true, selector: "lib-moses-chat", inputs: { customer: "customer" }, viewQueries: [{ propertyName: "chatEl", first: true, predicate: ["chatMessages"], descendants: true, read: ViewContainerRef }], ngImport: i0, template: "<div class=\"chat\">\r\n  <header>\r\n    <img src=\"/assets/molog512.png\" alt=\"Moses Logo\">\r\n    <h3>Personal Assistant</h3>\r\n    <span>{{ customer }}</span>\r\n  </header>\r\n\r\n  <main #chatMessages>\r\n    <div *ngIf=\"!hasLoggedIn\" class=\"login-container\">\r\n      <button (click)=\"hasLoggedIn = true\" class=\"fab-btn\">\r\n        <fa-icon [icon]=\"arrowRight\"></fa-icon>\r\n      </button>\r\n      <p>\r\n        <b>Hilfe ben\u00F6tigt? Chat starten!</b>\r\n        <br>\r\n        Ihre Angaben werden ausschliesslich zur Bearbeitung Ihres Anliegens genutzt. Detaillierte Informationen\r\n        erhalten Sie in unseren\r\n        <br>\r\n      </p>\r\n      <a href=\"https://moses-ai.com/privacy_policy.html\" target=\"_blank\">Datenschutzhinweisen</a>\r\n    </div>\r\n    <lib-moses-message *ngIf=\"hasLoggedIn\" [message]=\"startMessage\" [isAnswer]=\"true\"></lib-moses-message>\r\n  </main>\r\n\r\n  <footer>\r\n    <ng-container *ngIf=\"hasLoggedIn\">\r\n      <textarea (keydown.enter)=\"onEnter($event)\" [(ngModel)]=\"userInput\" placeholder=\"Schreibe hier..\"></textarea>\r\n      <button (click)=\"sendMsg()\">\r\n        <fa-icon [icon]=\"paperPlane\"></fa-icon>\r\n      </button>\r\n    </ng-container>\r\n  </footer>\r\n</div>", styles: ["@keyframes zoomIn{0%{-webkit-transform:scale(0);transform:scale(0);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:1}}.fab-btn{display:block;border-style:solid;border-radius:50%;text-align:center;color:#f0f0f0;box-shadow:0 0 4px #00000024,0 4px 8px #00000047;cursor:pointer;transition:scale .1s ease-out;background:#42a5f5;padding:0;animation:zoomIn .4s ease-in-out}.fab-btn>fa-icon{font-size:2em;line-height:1em}.fab-btn:hover{scale:1.3}.chat{width:300px;font-size:12px;line-height:22px;font-family:Montserrat,Helvetica Neue,Helvetica,Arial,\"sans-serif\";font-weight:500;-webkit-font-smoothing:antialiased;border-radius:10px;transition:all .2s ease-in-out;animation:zoomIn .4s ease-in-out;color:#4b4b4b;background:#fdfdfd}.chat>header{font-size:13px;color:#f3f3f3;height:55px;background:#2e2e2d;padding-top:8px;border-radius:10px 10px 0 0;border:1px solid #8f8c8c;border-bottom:none}.chat>header>img{border-radius:50%;width:55px;height:55px;float:left;margin:-30px 20px 10px;border:4px solid rgba(0,0,0,.21)}.chat>header>h3{margin:0}.chat>header>span{opacity:.4}.chat>main{height:300px;border-left:1px solid #8f8c8c;border-right:1px solid #8f8c8c;display:flex;flex-direction:column;overflow-y:auto;padding-bottom:5px}.chat>main>.login-container{align-content:center;padding:0 40px;text-align:center;height:100%}.chat>main>.login-container>button{margin:10px auto 30px;width:40px;height:40px}.chat>main>.login-container>a{margin:20px auto}.chat>footer{height:46px;display:flex;flex-direction:row;align-items:center;align-content:stretch;padding:4px 4px 0 12px;text-align:center;background:#fff;border:1px solid #8f8c8c;border-top:1px solid #eee;border-radius:0 0 10px 10px}.chat>footer>textarea{color:#4b4b4b;resize:none;font-size:13px;font-weight:400;width:100%;border:none;outline:none;font-family:Montserrat,Helvetica Neue,Helvetica,Arial,\"sans-serif\";align-self:end;height:30px}.chat>footer>button{background:none;border:none;font-size:1.8em;color:#bbb;cursor:pointer;padding:10px;transition:all .1s ease-out;transition-delay:20ms}.chat>footer>button:hover{color:#42a5f5}\n"], dependencies: [{ kind: "ngmodule", type: CommonModule }, { kind: "directive", type: i2.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "ngmodule", type: FormsModule }, { kind: "directive", type: i3.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { kind: "directive", type: i3.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i3.NgModel, selector: "[ngModel]:not([formControlName]):not([formControl])", inputs: ["name", "disabled", "ngModel", "ngModelOptions"], outputs: ["ngModelChange"], exportAs: ["ngModel"] }, { kind: "ngmodule", type: FontAwesomeModule }, { kind: "component", type: i4.FaIconComponent, selector: "fa-icon", inputs: ["icon", "title", "animation", "spin", "pulse", "mask", "styles", "flip", "size", "pull", "border", "inverse", "symbol", "rotate", "fixedWidth", "classes", "transform", "a11yRole"] }, { kind: "component", type: MessageComponent, selector: "lib-moses-message", inputs: ["isLoadIndicator", "message", "isAnswer"] }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.3.3", ngImport: i0, type: ChatComponent, decorators: [{
            type: Component,
            args: [{ selector: 'lib-moses-chat', standalone: true, imports: [CommonModule, FormsModule, FontAwesomeModule, MessageComponent], template: "<div class=\"chat\">\r\n  <header>\r\n    <img src=\"/assets/molog512.png\" alt=\"Moses Logo\">\r\n    <h3>Personal Assistant</h3>\r\n    <span>{{ customer }}</span>\r\n  </header>\r\n\r\n  <main #chatMessages>\r\n    <div *ngIf=\"!hasLoggedIn\" class=\"login-container\">\r\n      <button (click)=\"hasLoggedIn = true\" class=\"fab-btn\">\r\n        <fa-icon [icon]=\"arrowRight\"></fa-icon>\r\n      </button>\r\n      <p>\r\n        <b>Hilfe ben\u00F6tigt? Chat starten!</b>\r\n        <br>\r\n        Ihre Angaben werden ausschliesslich zur Bearbeitung Ihres Anliegens genutzt. Detaillierte Informationen\r\n        erhalten Sie in unseren\r\n        <br>\r\n      </p>\r\n      <a href=\"https://moses-ai.com/privacy_policy.html\" target=\"_blank\">Datenschutzhinweisen</a>\r\n    </div>\r\n    <lib-moses-message *ngIf=\"hasLoggedIn\" [message]=\"startMessage\" [isAnswer]=\"true\"></lib-moses-message>\r\n  </main>\r\n\r\n  <footer>\r\n    <ng-container *ngIf=\"hasLoggedIn\">\r\n      <textarea (keydown.enter)=\"onEnter($event)\" [(ngModel)]=\"userInput\" placeholder=\"Schreibe hier..\"></textarea>\r\n      <button (click)=\"sendMsg()\">\r\n        <fa-icon [icon]=\"paperPlane\"></fa-icon>\r\n      </button>\r\n    </ng-container>\r\n  </footer>\r\n</div>", styles: ["@keyframes zoomIn{0%{-webkit-transform:scale(0);transform:scale(0);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:1}}.fab-btn{display:block;border-style:solid;border-radius:50%;text-align:center;color:#f0f0f0;box-shadow:0 0 4px #00000024,0 4px 8px #00000047;cursor:pointer;transition:scale .1s ease-out;background:#42a5f5;padding:0;animation:zoomIn .4s ease-in-out}.fab-btn>fa-icon{font-size:2em;line-height:1em}.fab-btn:hover{scale:1.3}.chat{width:300px;font-size:12px;line-height:22px;font-family:Montserrat,Helvetica Neue,Helvetica,Arial,\"sans-serif\";font-weight:500;-webkit-font-smoothing:antialiased;border-radius:10px;transition:all .2s ease-in-out;animation:zoomIn .4s ease-in-out;color:#4b4b4b;background:#fdfdfd}.chat>header{font-size:13px;color:#f3f3f3;height:55px;background:#2e2e2d;padding-top:8px;border-radius:10px 10px 0 0;border:1px solid #8f8c8c;border-bottom:none}.chat>header>img{border-radius:50%;width:55px;height:55px;float:left;margin:-30px 20px 10px;border:4px solid rgba(0,0,0,.21)}.chat>header>h3{margin:0}.chat>header>span{opacity:.4}.chat>main{height:300px;border-left:1px solid #8f8c8c;border-right:1px solid #8f8c8c;display:flex;flex-direction:column;overflow-y:auto;padding-bottom:5px}.chat>main>.login-container{align-content:center;padding:0 40px;text-align:center;height:100%}.chat>main>.login-container>button{margin:10px auto 30px;width:40px;height:40px}.chat>main>.login-container>a{margin:20px auto}.chat>footer{height:46px;display:flex;flex-direction:row;align-items:center;align-content:stretch;padding:4px 4px 0 12px;text-align:center;background:#fff;border:1px solid #8f8c8c;border-top:1px solid #eee;border-radius:0 0 10px 10px}.chat>footer>textarea{color:#4b4b4b;resize:none;font-size:13px;font-weight:400;width:100%;border:none;outline:none;font-family:Montserrat,Helvetica Neue,Helvetica,Arial,\"sans-serif\";align-self:end;height:30px}.chat>footer>button{background:none;border:none;font-size:1.8em;color:#bbb;cursor:pointer;padding:10px;transition:all .1s ease-out;transition-delay:20ms}.chat>footer>button:hover{color:#42a5f5}\n"] }]
        }], ctorParameters: () => [{ type: i1.MosesChatGuiService }], propDecorators: { customer: [{
                type: Input
            }], chatEl: [{
                type: ViewChild,
                args: ['chatMessages', { read: ViewContainerRef }]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hhdC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9tb3Nlcy1jaGF0LWd1aS9zcmMvY29tcG9uZW50cy9jaGF0L2NoYXQuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbW9zZXMtY2hhdC1ndWkvc3JjL2NvbXBvbmVudHMvY2hhdC9jaGF0LmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUMvQyxPQUFPLEVBQ0wsU0FBUyxFQUVULEtBQUssRUFDTCxTQUFTLEVBQ1QsZ0JBQWdCLEdBQ2pCLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGtDQUFrQyxDQUFDO0FBQ3JFLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxxQ0FBcUMsQ0FBQztBQUNuRSxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sbUNBQW1DLENBQUM7QUFDakUsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDaEUsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGdCQUFnQixDQUFDOzs7Ozs7QUFTN0MsTUFBTSxPQUFPLGFBQWE7SUFpQnhCLFlBQW9CLE9BQTRCO1FBQTVCLFlBQU8sR0FBUCxPQUFPLENBQXFCO1FBaEJ2QyxhQUFRLEdBQVcsVUFBVSxDQUFDO1FBQ3ZDLGlCQUFZLEdBQ1YsNkRBQTZELENBQUM7UUFNaEUsY0FBUyxHQUFXLEVBQUUsQ0FBQztRQUV2QixnQkFBVyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUM7UUFFbEQsUUFBUTtRQUNSLGVBQVUsR0FBRyxZQUFZLENBQUM7UUFDMUIsZUFBVSxHQUFHLFlBQVksQ0FBQztJQUV5QixDQUFDO0lBRXBELE9BQU8sQ0FBQyxLQUFZ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LFdBQVcsOG1CQUFFLGlCQUFpQixtU0FBRSxnQkFBZ0I7OzJGQUk3RCxhQUFhO2tCQVB6QixTQUFTOytCQUNFLGdCQUFnQixjQUNkLElBQUksV0FDUCxDQUFDLFlBQVksRUFBRSxXQUFXLEVBQUUsaUJBQWlCLEVBQUUsZ0JBQWdCLENBQUM7d0ZBS2hFLFFBQVE7c0JBQWhCLEtBQUs7Z0JBS04sTUFBTTtzQkFETCxTQUFTO3VCQUFDLGNBQWMsRUFBRSxFQUFFLElBQUksRUFBRSxnQkFBZ0IsRUFBRSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE1vc2VzQ2hhdEd1aVNlcnZpY2UgfSBmcm9tICcuLy4uLy4uL2xpYi9tb3Nlcy1jaGF0LWd1aS5zZXJ2aWNlJztcclxuaW1wb3J0IHsgQ29tbW9uTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcclxuaW1wb3J0IHtcclxuICBDb21wb25lbnQsXHJcbiAgQ29tcG9uZW50UmVmLFxyXG4gIElucHV0LFxyXG4gIFZpZXdDaGlsZCxcclxuICBWaWV3Q29udGFpbmVyUmVmLFxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBGb250QXdlc29tZU1vZHVsZSB9IGZyb20gJ0Bmb3J0YXdlc29tZS9hbmd1bGFyLWZvbnRhd2Vzb21lJztcclxuaW1wb3J0IHsgZmFQYXBlclBsYW5lIH0gZnJvbSAnQGZvcnRhd2Vzb21lL2ZyZWUtcmVndWxhci1zdmctaWNvbnMnO1xyXG5pbXBvcnQgeyBmYUFycm93UmlnaHQgfSBmcm9tICdAZm9ydGF3ZXNvbWUvZnJlZS1zb2xpZC1zdmctaWNvbnMnO1xyXG5pbXBvcnQgeyBNZXNzYWdlQ29tcG9uZW50IH0gZnJvbSAnLi4vbWVzc2FnZS9tZXNzYWdlLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IEZvcm1zTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdsaWItbW9zZXMtY2hhdCcsXHJcbiAgc3RhbmRhbG9uZTogdHJ1ZSxcclxuICBpbXBvcnRzOiBbQ29tbW9uTW9kdWxlLCBGb3Jtc01vZHVsZSwgRm9udEF3ZXNvbWVNb2R1bGUsIE1lc3NhZ2VDb21wb25lbnRdLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9jaGF0LmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybDogJy4vY2hhdC5jb21wb25lbnQuc2NzcycsXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBDaGF0Q29tcG9uZW50IHtcclxuICBASW5wdXQoKSBjdXN0b21lcjogc3RyaW5nID0gJ0N1c3RvbWVyJztcclxuICBzdGFydE1lc3NhZ2U6IHN0cmluZyA9XHJcbiAgICAnWnUgd2VsY2hlciBNZXRyaWssIHdlbGNoZXMgQ29ubmVjdG9ycyBoYWJlbiBTaWUgZWluZSBGcmFnZT8nO1xyXG5cclxuICBAVmlld0NoaWxkKCdjaGF0TWVzc2FnZXMnLCB7IHJlYWQ6IFZpZXdDb250YWluZXJSZWYgfSlcclxuICBjaGF0RWwhOiBWaWV3Q29udGFpbmVyUmVmO1xyXG4gIGxhc3RNc2c/OiBDb21wb25lbnRSZWY8TWVzc2FnZUNvbXBvbmVudD47XHJcblxyXG4gIHVzZXJJbnB1dDogc3RyaW5nID0gJyc7XHJcblxyXG4gIGhhc0xvZ2dlZEluID0gdGhpcy5zZXJ2aWNlLmNoYXRIaXN0b3J5Lmxlbmd0aCA+IDA7XHJcblxyXG4gIC8vIEljb25zXHJcbiAgcGFwZXJQbGFuZSA9IGZhUGFwZXJQbGFuZTtcclxuICBhcnJvd1JpZ2h0ID0gZmFBcnJvd1JpZ2h0O1xyXG5cclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHNlcnZpY2U6IE1vc2VzQ2hhdEd1aVNlcnZpY2UpIHt9XHJcblxyXG4gIG9uRW50ZXIoZXZlbnQ6IEV2ZW50KSB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgdGhpcy5zZW5kTXNnKCk7XHJcbiAgfVxyXG5cclxuICBzZW5kTXNnKCkge1xyXG4gICAgaWYgKHRoaXMudXNlcklucHV0LnRyaW0oKS5sZW5ndGggPT09IDApIHJldHVybjtcclxuICAgIHRoaXMuc2hvd01zZyh0aGlzLnVzZXJJbnB1dCwgZmFsc2UpO1xyXG4gICAgdGhpcy5zaG93TG9hZEluZGljYXRvcigpO1xyXG4gICAgdGhpcy5zZXJ2aWNlXHJcbiAgICAgIC5zZW5kTXNnKHRoaXMudXNlcklucHV0KVxyXG4gICAgICAudGhlbigoYW5zd2VyKSA9PiB0aGlzLnNldEFuc3dlclRvTGFzdE1zZ0VsKGFuc3dlcikpXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB0aGlzLmhhbmRsZUVycm9yKGVycikpO1xyXG4gICAgdGhpcy51c2VySW5wdXQgPSAnJztcclxuICB9XHJcblxyXG4gIHByaXZhdGUgaGFuZGxlRXJyb3IoZXJyOiBzdHJpbmcpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIHRoaXMubGFzdE1zZz8uZGVzdHJveSgpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzaG93TG9hZEluZGljYXRvcigpIHtcclxuICAgIHRoaXMubGFzdE1zZyA9IHRoaXMuY2hhdEVsLmNyZWF0ZUNvbXBvbmVudChNZXNzYWdlQ29tcG9uZW50KTtcclxuICAgIHRoaXMubGFzdE1zZy5pbnN0YW5jZS5pc0Fuc3dlciA9IHRydWU7XHJcbiAgICB0aGlzLmxhc3RNc2cuaW5zdGFuY2UuaXNMb2FkSW5kaWNhdG9yID0gdHJ1ZTtcclxuICAgIHRoaXMuY2hhdEVsLmVsZW1lbnQubmF0aXZlRWxlbWVudC5hcHBlbmRDaGlsZChcclxuICAgICAgdGhpcy5sYXN0TXNnLmxvY2F0aW9uLm5hdGl2ZUVsZW1lbnRcclxuICAgICk7XHJcbiAgICB0aGlzLnNjcm9sbFRvQm90dG9tKCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNldEFuc3dlclRvTGFzdE1zZ0VsKGFuc3dlcjogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBtc2cgPSB0aGlzLmxhc3RNc2c/Lmluc3RhbmNlO1xyXG4gICAgaWYgKG1zZyAhPSBudWxsKSB7XHJcbiAgICAgIG1zZy5pc0xvYWRJbmRpY2F0b3IgPSBmYWxzZTtcclxuICAgICAgbXNnLm1lc3NhZ2UgPSBhbnN3ZXI7XHJcbiAgICB9XHJcbiAgICB0aGlzLnNjcm9sbFRvQm90dG9tKCk7XHJcbiAgfVxyXG5cclxuICBzaG93TXNnKG1zZzogc3RyaW5nLCBpc0Fuc3dlcjogYm9vbGVhbikge1xyXG4gICAgdGhpcy5sYXN0TXNnID0gdGhpcy5jaGF0RWwuY3JlYXRlQ29tcG9uZW50KE1lc3NhZ2VDb21wb25lbnQpO1xyXG4gICAgdGhpcy5sYXN0TXNnLmluc3RhbmNlLmlzQW5zd2VyID0gaXNBbnN3ZXI7XHJcbiAgICB0aGlzLmxhc3RNc2cuaW5zdGFuY2UubWVzc2FnZSA9IG1zZztcclxuICAgIHRoaXMuY2hhdEVsLmVsZW1lbnQubmF0aXZlRWxlbWVudC5hcHBlbmRDaGlsZChcclxuICAgICAgdGhpcy5sYXN0TXNnLmxvY2F0aW9uLm5hdGl2ZUVsZW1lbnRcclxuICAgICk7XHJcbiAgICB0aGlzLnNjcm9sbFRvQm90dG9tKCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNjcm9sbFRvQm90dG9tKCkge1xyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNoYXRFbDogSFRNTEVsZW1lbnQgPSB0aGlzLmNoYXRFbC5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAgIGNoYXRFbC5zY3JvbGxUb3AgPSBjaGF0RWwuc2Nyb2xsSGVpZ2h0O1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsIjxkaXYgY2xhc3M9XCJjaGF0XCI+XHJcbiAgPGhlYWRlcj5cclxuICAgIDxpbWcgc3JjPVwiL2Fzc2V0cy9tb2xvZzUxMi5wbmdcIiBhbHQ9XCJNb3NlcyBMb2dvXCI+XHJcbiAgICA8aDM+UGVyc29uYWwgQXNzaXN0YW50PC9oMz5cclxuICAgIDxzcGFuPnt7IGN1c3RvbWVyIH19PC9zcGFuPlxyXG4gIDwvaGVhZGVyPlxyXG5cclxuICA8bWFpbiAjY2hhdE1lc3NhZ2VzPlxyXG4gICAgPGRpdiAqbmdJZj1cIiFoYXNMb2dnZWRJblwiIGNsYXNzPVwibG9naW4tY29udGFpbmVyXCI+XHJcbiAgICAgIDxidXR0b24gKGNsaWNrKT1cImhhc0xvZ2dlZEluID0gdHJ1ZVwiIGNsYXNzPVwiZmFiLWJ0blwiPlxyXG4gICAgICAgIDxmYS1pY29uIFtpY29uXT1cImFycm93UmlnaHRcIj48L2ZhLWljb24+XHJcbiAgICAgIDwvYnV0dG9uPlxyXG4gICAgICA8cD5cclxuICAgICAgICA8Yj5IaWxmZSBiZW7DtnRpZ3Q/IENoYXQgc3RhcnRlbiE8L2I+XHJcbiAgICAgICAgPGJyPlxyXG4gICAgICAgIElocmUgQW5nYWJlbiB3ZXJkZW4gYXVzc2NobGllc3NsaWNoIHp1ciBCZWFyYmVpdHVuZyBJaHJlcyBBbmxpZWdlbnMgZ2VudXR6dC4gRGV0YWlsbGllcnRlIEluZm9ybWF0aW9uZW5cclxuICAgICAgICBlcmhhbHRlbiBTaWUgaW4gdW5zZXJlblxyXG4gICAgICAgIDxicj5cclxuICAgICAgPC9wPlxyXG4gICAgICA8YSBocmVmPVwiaHR0cHM6Ly9tb3Nlcy1haS5jb20vcHJpdmFjeV9wb2xpY3kuaHRtbFwiIHRhcmdldD1cIl9ibGFua1wiPkRhdGVuc2NodXR6aGlud2Vpc2VuPC9hPlxyXG4gICAgPC9kaXY+XHJcbiAgICA8bGliLW1vc2VzLW1lc3NhZ2UgKm5nSWY9XCJoYXNMb2dnZWRJblwiIFttZXNzYWdlXT1cInN0YXJ0TWVzc2FnZVwiIFtpc0Fuc3dlcl09XCJ0cnVlXCI+PC9saWItbW9zZXMtbWVzc2FnZT5cclxuICA8L21haW4+XHJcblxyXG4gIDxmb290ZXI+XHJcbiAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiaGFzTG9nZ2VkSW5cIj5cclxuICAgICAgPHRleHRhcmVhIChrZXlkb3duLmVudGVyKT1cIm9uRW50ZXIoJGV2ZW50KVwiIFsobmdNb2RlbCldPVwidXNlcklucHV0XCIgcGxhY2Vob2xkZXI9XCJTY2hyZWliZSBoaWVyLi5cIj48L3RleHRhcmVhPlxyXG4gICAgICA8YnV0dG9uIChjbGljayk9XCJzZW5kTXNnKClcIj5cclxuICAgICAgICA8ZmEtaWNvbiBbaWNvbl09XCJwYXBlclBsYW5lXCI+PC9mYS1pY29uPlxyXG4gICAgICA8L2J1dHRvbj5cclxuICAgIDwvbmctY29udGFpbmVyPlxyXG4gIDwvZm9vdGVyPlxyXG48L2Rpdj4iXX0=